<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>masc</title><meta name="description" content="A programming language that compiles to human-readable mips assembly."/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/a8a23829ab00b4f7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a8a23829ab00b4f7.css" data-n-g=""/><link rel="preload" href="/_next/static/css/bab74c2f662373c3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bab74c2f662373c3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b7f3493dfbfecbab.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-d81e5f7385263f04.js" defer=""></script><script src="/_next/static/chunks/pages/_app-9ecd8ce3c19ad944.js" defer=""></script><script src="/_next/static/chunks/664-60e06c839f82ba03.js" defer=""></script><script src="/_next/static/chunks/570-cc3fa65e7cc46989.js" defer=""></script><script src="/_next/static/chunks/pages/projects/%5Bproj_id%5D-bc83cee142fffbcf.js" defer=""></script><script src="/_next/static/IFyoF6zl0ZSH6mdbGcphM/_buildManifest.js" defer=""></script><script src="/_next/static/IFyoF6zl0ZSH6mdbGcphM/_ssgManifest.js" defer=""></script></head><body><div id="__next"><header style="background-image:url(&quot;/icons/masc.png&quot;)" class="bg-fixed"><div class="bg-gray-800 bg-opacity-90 text-gray-300"><div class="p-4 flex flex-col sm:flex-row"><a class="flex-1 text-white hover:underline inline-block" href="/"><span aria-label="Back to" role="img">&lt;</span> <span>pfg&#x27;s homepage</span></a><h1 class="flex-0 w-max text-2xl font-bold text-white flex justify-items-start items-center">masc</h1><div class="flex-1 flex justify-items-start items-center"></div></div><div class="max-w-screen-lg mx-auto"><div class="p-4"><div class="mb-3 flex flex-wrap gap-4"><a class="inline-block p-4 px-8 rounded-md text-white &lt;sm:min-w-max &lt;sm:flex-1 &lt;sm:text-center bg-gradient-to-r from-green-500 to-green-600" href="https://pfg.pw/masc" target="_blank" rel="noopener"><div class="inline-block align-bottom text-white"><svg width="24px" height="24px" viewBox="0 0 24 24"><title>External</title><g stroke-width="2.1" stroke="#fff" fill="none" stroke-linecap="round" stroke-linejoin="round"><polyline points="17 13.5 17 19.5 5 19.5 5 7.5 11 7.5"></polyline><path d="M14,4.5 L20,4.5 L20,10.5 M20,4.5 L11,13.5"></path></g></svg></div> <!-- -->View Demo</a><a class="inline-block p-4 px-8 rounded-md text-white &lt;sm:min-w-max &lt;sm:flex-1 &lt;sm:text-center bg-gray-500" href="https://github.com/pfgithub/masc" target="_blank" rel="noopener"><div class="inline-block align-bottom text-white"><svg width="24px" height="24px" role="img" viewBox="0 0 24 24"><title>Github</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" fill="#fff"></path></svg></div> <!-- -->Source Code</a></div></div></div></div></header><main class="bg-gray-300 min-h-screen"><div class="max-w-screen-lg mx-auto"><div class="p-4"><p class="mb-3">A programming language that compiles to human-readable mips assembly.<!-- --> </p><p class="mb-3">Made with<!-- --> <a href="https://www.typescriptlang.org/" class="text-blue-700 hover:underline" target="_blank" rel="noopener">Typescript</a>, <a href="https://en.wikipedia.org/wiki/Assembly_language" class="text-blue-700 hover:underline" target="_blank" rel="noopener">Assembly</a></p><div class="markdown-body -mx-4 sm:mx-0 bg-white sm:rounded-xl p-10"><html><head></head><body><p>web demo: <a href="https://pfg.pw/masc" target="_blank" rel="noopener">https://pfg.pw/masc</a></p>
<div class="markdown-heading"><h1 class="heading-element">mips masc</h1><a id="user-content-mips-masc" class="anchor" aria-label="Permalink: mips masc" href="https://github.com/pfgithub/masc/blob/master/#mips-masc" target="_blank" rel="noopener"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>generate mips from human code</p>
<p>example:</p>
<div class="highlight highlight-source-zig"><pre><span class="pl-s">\\.text</span>
<span class="pl-s">\\j main</span>

<span class="pl-k">fn</span> <span class="pl-en">gcd</span>(<span class="pl-v">a</span>: <span class="pl-k">i32</span>, <span class="pl-v">b</span>: <span class="pl-k">i32</span>) <span class="pl-k">i32</span> {
    <span class="pl-k">if</span> <span class="pl-v">b</span> <span class="pl-k">==</span> <span class="pl-c1">0</span> {<span class="pl-k">return</span> <span class="pl-v">a</span>;}
    <span class="pl-k">return</span> <span class="pl-v">gcd</span>(<span class="pl-v">b</span>, <span class="pl-v">a</span><span class="pl-k">%</span><span class="pl-v">b</span>);
}

<span class="pl-s">\\main:</span>

<span class="pl-v">print_int</span>(<span class="pl-v">gcd</span>(<span class="pl-c1">25</span>, <span class="pl-c1">15</span>));

<span class="pl-c">// ----- //</span>

<span class="pl-k">inline</span> <span class="pl-k">fn</span> <span class="pl-en">print_int</span>(<span class="pl-v">value</span>: <span class="pl-k">i32</span>) <span class="pl-k">void</span> {
	$<span class="pl-v">v0</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>;
	$<span class="pl-v">a0</span> <span class="pl-k">=</span> <span class="pl-v">value</span>;
	<span class="pl-v">syscall</span>();
}
<span class="pl-k">inline</span> <span class="pl-k">fn</span> <span class="pl-en">syscall</span>() <span class="pl-k">void</span> {
	<span class="pl-s">\\syscall</span>
	<span class="pl-k">!</span><span class="pl-v">clear</span> $<span class="pl-v">call</span>;
}</pre></div>
<p align="center">â†“</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-s">.text                                             </span><span class="pl-c"><span class="pl-c">#</span> .text</span>
<span class="pl-s">j main                                            </span><span class="pl-c"><span class="pl-c">#</span> j main</span>
<span class="pl-c"><span class="pl-c">#</span> ====================</span>
<span class="pl-c"><span class="pl-c">#</span> jal call_gcd</span>
<span class="pl-c"><span class="pl-c">#</span> args:</span>
<span class="pl-c"><span class="pl-c">#</span>    $a0: a - i32</span>
<span class="pl-c"><span class="pl-c">#</span>    $a1: b - i32</span>
<span class="pl-c"><span class="pl-c">#</span> return:</span>
<span class="pl-c"><span class="pl-c">#</span>    $v0: i32</span>
<span class="pl-c"><span class="pl-c">#</span> ====================</span>
<span class="pl-ent">call_gcd</span>:                                         <span class="pl-c"><span class="pl-c">#</span> fn gcd(a: i32, b: i32) i32{</span>
    <span class="pl-c"><span class="pl-c">#</span> save used s registers to stack</span>
    <span class="pl-s">subiu $sp, $sp, 4                             </span><span class="pl-c"><span class="pl-c">#</span>     $sp = &amp;$sp[-1]</span>
    <span class="pl-s">sw $ra, 0($sp)                                </span><span class="pl-c"><span class="pl-c">#</span>     $sp[0] = $ra</span>
                                                  <span class="pl-c"><span class="pl-c">#</span></span>
    <span class="pl-s">move $t0 $a0                                  </span><span class="pl-c"><span class="pl-c">#</span>     a = $a0</span>
    <span class="pl-s">move $t1 $a1                                  </span><span class="pl-c"><span class="pl-c">#</span>     b = $a1</span>
    <span class="pl-c"><span class="pl-c">#</span> body</span>
    <span class="pl-s">bnez $t1, if_end                              </span><span class="pl-c"><span class="pl-c">#</span>     if b == 0 {</span>
        <span class="pl-s">move $v0 $t0                              </span><span class="pl-c"><span class="pl-c">#</span>         .      a</span>
        <span class="pl-s">j deinit_gcd                              </span><span class="pl-c"><span class="pl-c">#</span>         return ^;</span>
    <span class="pl-ent">if_end</span>:                                       <span class="pl-c"><span class="pl-c">#</span>     }</span>
    <span class="pl-s">move $a0 $t1                                  </span><span class="pl-c"><span class="pl-c">#</span>     .               b</span>
    <span class="pl-s">rem $a1, $t0 $t1                              </span><span class="pl-c"><span class="pl-c">#</span>     |                  a % b</span>
    <span class="pl-s">jal call_gcd                                  </span><span class="pl-c"><span class="pl-c">#</span>     |           gcd(^, ^^^^^)</span>
    <span class="pl-s">move $v0, $v0                                 </span><span class="pl-c"><span class="pl-c">#</span>     return$v0 = ^^^^^^^^^^^^^</span>
                                                  <span class="pl-c"><span class="pl-c">#</span></span>
<span class="pl-ent">deinit_gcd</span>:                                       <span class="pl-c"><span class="pl-c">#</span> cleanup:</span>
    <span class="pl-c"><span class="pl-c">#</span> reload used s registers from stack</span>
    <span class="pl-s">lw $ra, 0($sp)                                </span><span class="pl-c"><span class="pl-c">#</span>     $ra = $sp[0]</span>
    <span class="pl-s">addiu $sp, $sp, 4                             </span><span class="pl-c"><span class="pl-c">#</span>     $sp = &amp;$sp[1]</span>
<span class="pl-s">jr $ra                                            </span><span class="pl-c"><span class="pl-c">#</span> }</span>
<span class="pl-ent">main</span>:                                             <span class="pl-c"><span class="pl-c">#</span> main:</span>
<span class="pl-s">li $a0 25                                         </span><span class="pl-c"><span class="pl-c">#</span> .             25</span>
<span class="pl-s">li $a1 15                                         </span><span class="pl-c"><span class="pl-c">#</span> |                 15</span>
<span class="pl-s">jal call_gcd                                      </span><span class="pl-c"><span class="pl-c">#</span> |         gcd(^^, ^^)</span>
<span class="pl-s">move $t0, $v0                                     </span><span class="pl-c"><span class="pl-c">#</span> |         ^^^^^^^^^^^</span>
<span class="pl-s">li $v0 1                                          </span><span class="pl-c"><span class="pl-c">#</span> print_int(^^^^^^^^^^^)</span>
<span class="pl-s">move $a0 $t0                                      </span><span class="pl-c"><span class="pl-c">#</span></span>
<span class="pl-s">syscall                                           </span><span class="pl-c"><span class="pl-c">#</span></span></pre></div>
<div class="markdown-heading"><h2 class="heading-element">syntax</h2><a id="user-content-syntax" class="anchor" aria-label="Permalink: syntax" href="https://github.com/pfgithub/masc/blob/master/#syntax" target="_blank" rel="noopener"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>inspired by zig.</p>
<p><a href="https://github.com/pfgithub/masc/tree/master/src/tests" target="_blank" rel="noopener">examples</a>.</p>
<p>statement:</p>
<ul>
<li>
<code>var varname: TYPE = EXPRESSION;</code> - define variable</li>
<li>
<code>variable | register = EXPRESSION;</code> - set variable. eg <code>myvar = 3;</code> or <code>$v0 = 5;</code>
</li>
<li>
<code>save EXPRESSION = EXPRESSION</code> - save into memory. eg <code>save myptr.* = 25;</code>. you may wonder why this is not just <code>myptr.* = 25;</code>. it should be.</li>
<li>
<code>inline? fn function_name(arg_name: TYPE, ...) { STATEMENT... }</code> - define Â¿inline? function. make sure to jump over functions.
functions will save any needed things to the stack (and unneeded because they will always save $ra even if they don't call any functions oops)</li>
<li>
<code>loop { STATEMENT ... }</code> - loop forever. break/continue out of the loop.</li>
<li>
<code>if EXPRESSION operator EXPRESSION { STATEMENT... }</code> - expression: <code>&lt;=</code>, <code>&lt;</code>, <code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&gt;=</code>.</li>
<li>
<code>!clear $ra, $call, ...</code> - tell the register allocator that these variables cannot be used. <code>$call</code> expands into $t0-7, $a0-4, $ra, $v0-1. this way, using a variable across a syscall makes it go into $s0-7.</li>
<li>
<code>\\inline assembly...</code> - inline assembly currently has no option to use variables. make sure to !clear any used registers after inline assembly. eg: <code>\syscall</code>
</li>
<li>
<code>return EXPRESSION?;</code> - return a value from a function</li>
<li>
<code>break;</code> - break from a loop</li>
<li>
<code>continue;</code> - continue in a loop</li>
</ul>
<p>types:</p>
<ul>
<li>
<code>u32</code>, <code>i32</code>, <code>u8</code> - unsigned and signed integer types</li>
<li>
<code>[*]TYPE</code> - pointer to array (indexable, math supported)</li>
<li>
<code>*TYPE</code> - pointer to one (not indexable, no math)</li>
<li>
<code>void</code> - nothing. for use as a return value</li>
<li>
<code>any</code> - any value (up to 32 bits)</li>
</ul>
<p>expression:</p>
<ul>
<li><code>variable_name</code></li>
<li>
<code>@TYPE:data_name</code> - get something from the .data section with name data_name and type TYPE. example: <code>@i32:len</code> or <code>@[*]i32:x[25]</code>. masc doesn't help with defining items in the .data section, do it yourself.</li>
<li>
<code>$register_name</code> - use a register</li>
<li>
<code>function_name(EXPRESSION, ...)</code> - call a function</li>
<li>
<code>EXPRESSION + - * / ^ % EXPRESSION</code> - math. eg <code>1 + 1</code> or <code>5 * 3 + 6 % 8</code>. <code>^</code> is binary xor.</li>
<li>
<code>EXPRESSION[EXPRESSION]</code> - index array, eg <code>somearray[5]</code>
</li>
<li>
<code>EXPRESSION.*</code> - get value of pointer, eg <code>somepointer.*</code>
</li>
<li>
<code>&amp;EXPRESSION</code> - address of expression, eg <code>&amp;somepointer[2]</code>
</li>
<li>
<code>undefined</code> - anything. eg <code>var varname: u32 = undefined;</code>
</li>
<li>
<code>25</code> - any number, eg <code>-8</code> or <code>5325</code>. no binary literals, hex literals, or floating point numbers supported.</li>
</ul>
<p>comments:</p>
<ul>
<li>
<code>// asdfnjdksalk</code> - comment that will not be visible in the output code</li>
<li>
<code>/* asdfnjdks */</code> - comment that will not be visible in the output code</li>
<li>
<code>\\# comment that will be visible in the output code</code> (inline assembly "#")</li>
<li>
<code>\\</code> - newline that will be visible in the output code</li>
</ul>
<p>there's probably more that I'm missing. look at the examples.</p>
<div class="markdown-heading"><h2 class="heading-element">notes</h2><a id="user-content-notes" class="anchor" aria-label="Permalink: notes" href="https://github.com/pfgithub/masc/blob/master/#notes" target="_blank" rel="noopener"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<p>all variables are stored in a register. if you run out of registers, save some
things to the stack manually yourself.</p>
<div class="markdown-heading"><h2 class="heading-element">issues</h2><a id="user-content-issues" class="anchor" aria-label="Permalink: issues" href="https://github.com/pfgithub/masc/blob/master/#issues" target="_blank" rel="noopener"><span aria-hidden="true" class="octicon octicon-link"></span></a></div>
<ul>
<li>no parenthesis expression. you can't do <code>(1 + 1) * 2</code>
</li>
<li>newlines have to be explicitly preserved</li>
<li>inline function call comments are all on one line</li>
<li>no strings, no way to make a print function</li>
<li>no way to make a macro fn</li>
<li>lots of missing integer types</li>
<li>supporting larger types (eg doubles) would require a pretty big refactor probably</li>
<li>too many registers has no position associated with the error</li>
<li>register allocation bugs probably</li>
<li>intermediate representation is using untyped strings and regex replace rather than actual objects</li>
</ul>
</body></html></div></div></div></main><footer class="bg-gray-600 text-white"><div class="max-w-screen-lg mx-auto"><div class="p-4"><a href="https://github.com/pfgithub/pfgithub.github.com/" target="_blank" rel="noopener" class="underline">Source</a> Â·<!-- --> <a href="https://github.com/pfgithub/pfgithub.github.com/" target="_blank" rel="noopener" class="underline">Edit</a></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"proj_id":"masc","project":{"img":[324,174,"/icons/masc.png"],"title":"masc","body":["A programming language that compiles to human-readable mips assembly."],"technologies":["typescript","assembly"],"github":{"repo":"pfgithub/masc","branch":"master","file":"README.md"},"site":{"kind":"demo","url":"https://pfg.pw/masc"}},"project_readme":{"text":"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cp\u003eweb demo: \u003ca href=\"https://pfg.pw/masc\" target=\"_blank\" rel=\"noopener\"\u003ehttps://pfg.pw/masc\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\"\u003e\u003ch1 class=\"heading-element\"\u003emips masc\u003c/h1\u003e\u003ca id=\"user-content-mips-masc\" class=\"anchor\" aria-label=\"Permalink: mips masc\" href=\"https://github.com/pfgithub/masc/blob/master/#mips-masc\" target=\"_blank\" rel=\"noopener\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp\u003egenerate mips from human code\u003c/p\u003e\n\u003cp\u003eexample:\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-zig\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e\\\\.text\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003e\\\\j main\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003efn\u003c/span\u003e \u003cspan class=\"pl-en\"\u003egcd\u003c/span\u003e(\u003cspan class=\"pl-v\"\u003ea\u003c/span\u003e: \u003cspan class=\"pl-k\"\u003ei32\u003c/span\u003e, \u003cspan class=\"pl-v\"\u003eb\u003c/span\u003e: \u003cspan class=\"pl-k\"\u003ei32\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003ei32\u003c/span\u003e {\n    \u003cspan class=\"pl-k\"\u003eif\u003c/span\u003e \u003cspan class=\"pl-v\"\u003eb\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e==\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e0\u003c/span\u003e {\u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-v\"\u003ea\u003c/span\u003e;}\n    \u003cspan class=\"pl-k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"pl-v\"\u003egcd\u003c/span\u003e(\u003cspan class=\"pl-v\"\u003eb\u003c/span\u003e, \u003cspan class=\"pl-v\"\u003ea\u003c/span\u003e\u003cspan class=\"pl-k\"\u003e%\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eb\u003c/span\u003e);\n}\n\n\u003cspan class=\"pl-s\"\u003e\\\\main:\u003c/span\u003e\n\n\u003cspan class=\"pl-v\"\u003eprint_int\u003c/span\u003e(\u003cspan class=\"pl-v\"\u003egcd\u003c/span\u003e(\u003cspan class=\"pl-c1\"\u003e25\u003c/span\u003e, \u003cspan class=\"pl-c1\"\u003e15\u003c/span\u003e));\n\n\u003cspan class=\"pl-c\"\u003e// ----- //\u003c/span\u003e\n\n\u003cspan class=\"pl-k\"\u003einline\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efn\u003c/span\u003e \u003cspan class=\"pl-en\"\u003eprint_int\u003c/span\u003e(\u003cspan class=\"pl-v\"\u003evalue\u003c/span\u003e: \u003cspan class=\"pl-k\"\u003ei32\u003c/span\u003e) \u003cspan class=\"pl-k\"\u003evoid\u003c/span\u003e {\n\t$\u003cspan class=\"pl-v\"\u003ev0\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-c1\"\u003e1\u003c/span\u003e;\n\t$\u003cspan class=\"pl-v\"\u003ea0\u003c/span\u003e \u003cspan class=\"pl-k\"\u003e=\u003c/span\u003e \u003cspan class=\"pl-v\"\u003evalue\u003c/span\u003e;\n\t\u003cspan class=\"pl-v\"\u003esyscall\u003c/span\u003e();\n}\n\u003cspan class=\"pl-k\"\u003einline\u003c/span\u003e \u003cspan class=\"pl-k\"\u003efn\u003c/span\u003e \u003cspan class=\"pl-en\"\u003esyscall\u003c/span\u003e() \u003cspan class=\"pl-k\"\u003evoid\u003c/span\u003e {\n\t\u003cspan class=\"pl-s\"\u003e\\\\syscall\u003c/span\u003e\n\t\u003cspan class=\"pl-k\"\u003e!\u003c/span\u003e\u003cspan class=\"pl-v\"\u003eclear\u003c/span\u003e $\u003cspan class=\"pl-v\"\u003ecall\u003c/span\u003e;\n}\u003c/pre\u003e\u003c/div\u003e\n\u003cp align=\"center\"\u003eâ†“\u003c/p\u003e\n\u003cdiv class=\"highlight highlight-source-yaml\"\u003e\u003cpre\u003e\u003cspan class=\"pl-s\"\u003e.text                                             \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e .text\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003ej main                                            \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e j main\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ====================\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e jal call_gcd\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e args:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e    $a0: a - i32\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e    $a1: b - i32\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e return:\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e    $v0: i32\u003c/span\u003e\n\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e ====================\u003c/span\u003e\n\u003cspan class=\"pl-ent\"\u003ecall_gcd\u003c/span\u003e:                                         \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e fn gcd(a: i32, b: i32) i32{\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e save used s registers to stack\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003esubiu $sp, $sp, 4                             \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     $sp = \u0026amp;$sp[-1]\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003esw $ra, 0($sp)                                \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     $sp[0] = $ra\u003c/span\u003e\n                                                  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003emove $t0 $a0                                  \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     a = $a0\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003emove $t1 $a1                                  \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     b = $a1\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e body\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003ebnez $t1, if_end                              \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     if b == 0 {\u003c/span\u003e\n        \u003cspan class=\"pl-s\"\u003emove $v0 $t0                              \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e         .      a\u003c/span\u003e\n        \u003cspan class=\"pl-s\"\u003ej deinit_gcd                              \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e         return ^;\u003c/span\u003e\n    \u003cspan class=\"pl-ent\"\u003eif_end\u003c/span\u003e:                                       \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     }\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003emove $a0 $t1                                  \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     .               b\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003erem $a1, $t0 $t1                              \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     |                  a % b\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003ejal call_gcd                                  \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     |           gcd(^, ^^^^^)\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003emove $v0, $v0                                 \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     return$v0 = ^^^^^^^^^^^^^\u003c/span\u003e\n                                                  \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-ent\"\u003edeinit_gcd\u003c/span\u003e:                                       \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e cleanup:\u003c/span\u003e\n    \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e reload used s registers from stack\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003elw $ra, 0($sp)                                \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     $ra = $sp[0]\u003c/span\u003e\n    \u003cspan class=\"pl-s\"\u003eaddiu $sp, $sp, 4                             \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e     $sp = \u0026amp;$sp[1]\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003ejr $ra                                            \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e }\u003c/span\u003e\n\u003cspan class=\"pl-ent\"\u003emain\u003c/span\u003e:                                             \u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e main:\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eli $a0 25                                         \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e .             25\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eli $a1 15                                         \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e |                 15\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003ejal call_gcd                                      \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e |         gcd(^^, ^^)\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003emove $t0, $v0                                     \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e |         ^^^^^^^^^^^\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003eli $v0 1                                          \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e print_int(^^^^^^^^^^^)\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003emove $a0 $t0                                      \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"pl-s\"\u003esyscall                                           \u003c/span\u003e\u003cspan class=\"pl-c\"\u003e\u003cspan class=\"pl-c\"\u003e#\u003c/span\u003e\u003c/span\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"markdown-heading\"\u003e\u003ch2 class=\"heading-element\"\u003esyntax\u003c/h2\u003e\u003ca id=\"user-content-syntax\" class=\"anchor\" aria-label=\"Permalink: syntax\" href=\"https://github.com/pfgithub/masc/blob/master/#syntax\" target=\"_blank\" rel=\"noopener\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp\u003einspired by zig.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/pfgithub/masc/tree/master/src/tests\" target=\"_blank\" rel=\"noopener\"\u003eexamples\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003estatement:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003evar varname: TYPE = EXPRESSION;\u003c/code\u003e - define variable\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003evariable | register = EXPRESSION;\u003c/code\u003e - set variable. eg \u003ccode\u003emyvar = 3;\u003c/code\u003e or \u003ccode\u003e$v0 = 5;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003esave EXPRESSION = EXPRESSION\u003c/code\u003e - save into memory. eg \u003ccode\u003esave myptr.* = 25;\u003c/code\u003e. you may wonder why this is not just \u003ccode\u003emyptr.* = 25;\u003c/code\u003e. it should be.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003einline? fn function_name(arg_name: TYPE, ...) { STATEMENT... }\u003c/code\u003e - define Â¿inline? function. make sure to jump over functions.\nfunctions will save any needed things to the stack (and unneeded because they will always save $ra even if they don't call any functions oops)\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eloop { STATEMENT ... }\u003c/code\u003e - loop forever. break/continue out of the loop.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eif EXPRESSION operator EXPRESSION { STATEMENT... }\u003c/code\u003e - expression: \u003ccode\u003e\u0026lt;=\u003c/code\u003e, \u003ccode\u003e\u0026lt;\u003c/code\u003e, \u003ccode\u003e==\u003c/code\u003e, \u003ccode\u003e!=\u003c/code\u003e, \u003ccode\u003e\u0026gt;\u003c/code\u003e, \u003ccode\u003e\u0026gt;=\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e!clear $ra, $call, ...\u003c/code\u003e - tell the register allocator that these variables cannot be used. \u003ccode\u003e$call\u003c/code\u003e expands into $t0-7, $a0-4, $ra, $v0-1. this way, using a variable across a syscall makes it go into $s0-7.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\\\\inline assembly...\u003c/code\u003e - inline assembly currently has no option to use variables. make sure to !clear any used registers after inline assembly. eg: \u003ccode\u003e\\syscall\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ereturn EXPRESSION?;\u003c/code\u003e - return a value from a function\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003ebreak;\u003c/code\u003e - break from a loop\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003econtinue;\u003c/code\u003e - continue in a loop\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003etypes:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003eu32\u003c/code\u003e, \u003ccode\u003ei32\u003c/code\u003e, \u003ccode\u003eu8\u003c/code\u003e - unsigned and signed integer types\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e[*]TYPE\u003c/code\u003e - pointer to array (indexable, math supported)\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e*TYPE\u003c/code\u003e - pointer to one (not indexable, no math)\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003evoid\u003c/code\u003e - nothing. for use as a return value\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eany\u003c/code\u003e - any value (up to 32 bits)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eexpression:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003evariable_name\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e@TYPE:data_name\u003c/code\u003e - get something from the .data section with name data_name and type TYPE. example: \u003ccode\u003e@i32:len\u003c/code\u003e or \u003ccode\u003e@[*]i32:x[25]\u003c/code\u003e. masc doesn't help with defining items in the .data section, do it yourself.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e$register_name\u003c/code\u003e - use a register\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003efunction_name(EXPRESSION, ...)\u003c/code\u003e - call a function\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eEXPRESSION + - * / ^ % EXPRESSION\u003c/code\u003e - math. eg \u003ccode\u003e1 + 1\u003c/code\u003e or \u003ccode\u003e5 * 3 + 6 % 8\u003c/code\u003e. \u003ccode\u003e^\u003c/code\u003e is binary xor.\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eEXPRESSION[EXPRESSION]\u003c/code\u003e - index array, eg \u003ccode\u003esomearray[5]\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eEXPRESSION.*\u003c/code\u003e - get value of pointer, eg \u003ccode\u003esomepointer.*\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\u0026amp;EXPRESSION\u003c/code\u003e - address of expression, eg \u003ccode\u003e\u0026amp;somepointer[2]\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003eundefined\u003c/code\u003e - anything. eg \u003ccode\u003evar varname: u32 = undefined;\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e25\u003c/code\u003e - any number, eg \u003ccode\u003e-8\u003c/code\u003e or \u003ccode\u003e5325\u003c/code\u003e. no binary literals, hex literals, or floating point numbers supported.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ecomments:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003ccode\u003e// asdfnjdksalk\u003c/code\u003e - comment that will not be visible in the output code\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e/* asdfnjdks */\u003c/code\u003e - comment that will not be visible in the output code\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\\\\# comment that will be visible in the output code\u003c/code\u003e (inline assembly \"#\")\u003c/li\u003e\n\u003cli\u003e\n\u003ccode\u003e\\\\\u003c/code\u003e - newline that will be visible in the output code\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ethere's probably more that I'm missing. look at the examples.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\"\u003e\u003ch2 class=\"heading-element\"\u003enotes\u003c/h2\u003e\u003ca id=\"user-content-notes\" class=\"anchor\" aria-label=\"Permalink: notes\" href=\"https://github.com/pfgithub/masc/blob/master/#notes\" target=\"_blank\" rel=\"noopener\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cp\u003eall variables are stored in a register. if you run out of registers, save some\nthings to the stack manually yourself.\u003c/p\u003e\n\u003cdiv class=\"markdown-heading\"\u003e\u003ch2 class=\"heading-element\"\u003eissues\u003c/h2\u003e\u003ca id=\"user-content-issues\" class=\"anchor\" aria-label=\"Permalink: issues\" href=\"https://github.com/pfgithub/masc/blob/master/#issues\" target=\"_blank\" rel=\"noopener\"\u003e\u003cspan aria-hidden=\"true\" class=\"octicon octicon-link\"\u003e\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\n\u003cul\u003e\n\u003cli\u003eno parenthesis expression. you can't do \u003ccode\u003e(1 + 1) * 2\u003c/code\u003e\n\u003c/li\u003e\n\u003cli\u003enewlines have to be explicitly preserved\u003c/li\u003e\n\u003cli\u003einline function call comments are all on one line\u003c/li\u003e\n\u003cli\u003eno strings, no way to make a print function\u003c/li\u003e\n\u003cli\u003eno way to make a macro fn\u003c/li\u003e\n\u003cli\u003elots of missing integer types\u003c/li\u003e\n\u003cli\u003esupporting larger types (eg doubles) would require a pretty big refactor probably\u003c/li\u003e\n\u003cli\u003etoo many registers has no position associated with the error\u003c/li\u003e\n\u003cli\u003eregister allocation bugs probably\u003c/li\u003e\n\u003cli\u003eintermediate representation is using untyped strings and regex replace rather than actual objects\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/body\u003e\u003c/html\u003e"}},"__N_SSG":true},"page":"/projects/[proj_id]","query":{"proj_id":"masc"},"buildId":"IFyoF6zl0ZSH6mdbGcphM","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>